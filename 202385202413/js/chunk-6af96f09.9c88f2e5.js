(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6af96f09"],{"2f21":function(t,e,i){"use strict";var n=i("79e5");t.exports=function(t,e){return!!t&&n((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"456d":function(t,e,i){var n=i("4bf8"),s=i("0d58");i("5eda")("keys",(function(){return function(t){return s(n(t))}}))},"4da0":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAeCAYAAAAy2w7YAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAADISURBVEiJ7ZaxDcIwEEXfRWEARMMCbEGRGahwi5KCNWhYAioatggNGzACBRUTRDkKEEpQIuyAEQL/yt/y3Tv7ZMuCg3Q6yxBZAmdiJrJZH2xjIxfQFSIDkBGFLFxC3UDI4D5U+h5B3SVq0hxIPHN2EUrPMwRAak5NqmpSfTVrU56P9SiA/IHUpPntClj5NsUWxSSOvlHfc3QBFEAB9Ieg52+dskcorH1XkGxXYxffpt/v0QkYvuMnBByrpr6jUrLHBZ0hpcyrExc3lz6u5grXogAAAABJRU5ErkJggg=="},"55dd":function(t,e,i){"use strict";var n=i("5ca1"),s=i("d8e8"),o=i("4bf8"),a=i("79e5"),r=[].sort,l=[1,2,3];n(n.P+n.F*(a((function(){l.sort(void 0)}))||!a((function(){l.sort(null)}))||!i("2f21")(r)),"Array",{sort:function(t){return void 0===t?r.call(o(this)):r.call(o(this),s(t))}})},"5d58":function(t,e,i){t.exports=i("d8d6")},"5df3":function(t,e,i){"use strict";var n=i("02f4")(!0);i("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})}))},"5eda":function(t,e,i){var n=i("5ca1"),s=i("8378"),o=i("79e5");t.exports=function(t,e){var i=(s.Object||{})[t]||Object[t],a={};a[t]=e(i),n(n.S+n.F*o((function(){i(1)})),"Object",a)}},"67bb":function(t,e,i){t.exports=i("f921")},"8a6f":function(t,e,i){"use strict";i.r(e);i("7f7f");var n=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"cesium-container"}},[e("div",{staticClass:"btns"},[e("div",{staticClass:"ul"},t._l(t.btns,(function(i,n){return e("div",{key:n,staticClass:"li",class:{active:i.name===t.active},on:{click:function(e){return t.handleClick(i)}}},[t._v("\n        "+t._s(i.name))])})),0)])])},s=[],o=(i("55dd"),i("c5f6"),i("67bb")),a=i.n(o),r=i("5d58"),l=i.n(r);function c(t){return c="function"==typeof a.a&&"symbol"==typeof l.a?function(t){return typeof t}:function(t){return t&&"function"==typeof a.a&&t.constructor===a.a&&t!==a.a.prototype?"symbol":typeof t},c(t)}i("28a5"),i("456d"),i("5df3"),i("ac6a");var u=i("d225"),h=i("b0b4"),d=i("c31f");function p(t,e){var i="";if("point"===t){var n=e.name?"".concat(e.name,"\n"):"",s=e.longitude?"经度：".concat(parseFloat(e.longitude).toFixed(7),"\n"):"",o=e.latitude?"纬度：".concat(parseFloat(e.latitude).toFixed(7),"\n"):"",a=parseFloat(e.altitude)||0===parseFloat(e.altitude)?"高度：".concat(parseFloat(e.altitude).toFixed(1),"m"):"";i="".concat(n).concat(s).concat(o).concat(a)}else if("polyline"===t){var r=e.name?"".concat(e.name,"\n"):"",l=e.value&&parseFloat(e.value)?"总距离：".concat(e.value,"米"):"",c=e.subValue&&parseFloat(e.subValue)?"".concat(e.subValue,"米"):"";i="".concat(r).concat(l).concat(c)}else if("polygon"===t){var u=e.name?"".concat(e.name,"\n"):"",h=e.value&&parseFloat(e.value)?"".concat(e.value,"平方米"):"";i="".concat(u).concat(h)}else if("text"===t){var d=e.name?"".concat(v(e.name,10).join("\n")):"";i="".concat(d)}else if("vertex"===t){var p=e.name?"".concat(e.name,"\n"):"";i="".concat(p)}return i}function v(t,e){for(var i=[],n=0;n<t.length;n+=e)i.push(t.slice(n,n+e));return i}function m(t,e){t&&t.polygon&&(t.polygon.hierarchy=new Cesium.CallbackProperty((function(){return new Cesium.PolygonHierarchy(e)}),!1))}function f(t,e){t&&t.polygon&&(t.polygon.material=e)}function g(t,e){t&&t.polyline&&(t.polyline.positions=new Cesium.CallbackProperty((function(){return e}),!1))}function y(t,e){t&&t.polyline&&(t.polyline.material=e)}function C(t,e){t&&t.label&&(t.label.fillColor=e)}function P(t,e){t&&t.label&&(t.label.font=e)}function S(t,e){t&&t.label&&(t.label.text=e)}function w(t,e){t&&t.position&&t.position.setValue(e)}function b(t,e){t&&t.point&&(t.point.pixelSize=e)}function E(t,e){t&&t.point&&(t.point.color=e)}var A=i("5c96"),V=function(){function t(e){Object(u["a"])(this,t),this.ID=(new Date).toLocaleString(),this.drawingMode="polygon",this.disabledEvent=!1,this.pointPositionVisible=!1,this.plotName="",this.activeShapePoints=[],this.activeSubLine=[],this.verticesPosition=[],this.activeShapeComputed=0,this.labelFont="30px sans-serif",this.colorValue="#FFFFFF80",this.plotBaseEntity=null,this.eventHandler=null,this.activeShape=null,this.floatingPoint=null,this.areaLabelEntity=null,this.distanceLabelEntities={},this.vertexEntities={},this.addButtonEntities={},this.totalDistanceLabelEntity=null,this.deleteVertexButtonEntity=null,this.plotting=!1,this.currentEditPolygonTopPoint=null,this.plotTipDOM=null,this.plotPositionDOM=null,this.finishPointEntity=null,this.overlookStatus=!0,this.editEntityId="",this.leftDownFlag=!1,this.startMovePoint=null,this.startMoveHeight=0,this.pickedEntity=null,this.pickedEntityHeight=0,this.platform="pc",this.MousePosition=e.MousePosition,this.PlottingStatus=e.PlottingStatus,this.Finish=e.Finish,this.VerticesFinish=e.VerticesFinish,this.CurrentEditVertice=e.CurrentEditVertice,this.VolumeAnalysisResult=e.VolumeAnalysisResult,this.VolumeAnalysisProgress=e.VolumeAnalysisProgress,this.maxHeigh=-1e6,this.VolumeAnalysisEntities=[],this.VolumeAnalysisBasePrimitive=null,this.VolumeAnalysisInstances=[],this._renderFrame=0,this.indexV1=0,this.cutAreaV1=0,this.cutVolumeV1=0,this.fillAreaV1=0,this.fillVolumeV1=0,this.noAreaV1=0,this.extrudedHeightV1=0,this._indicesV1=void 0,this._positionsV1=void 0,this.KmlDataSource=null,this.PlottingStatus&&this.PlottingStatus(!1),e.defaultColorValue&&(this.colorValue=e.defaultColorValue),e.pointPositionVisible&&(this.pointPositionVisible=e.pointPositionVisible),e.platform&&(this.platform=e.platform)}return Object(h["a"])(t,[{key:"removeKmlDataSource",value:function(){viewer.dataSources.remove(this.KmlDataSource)}},{key:"addKmlDataSource",value:function(t,e){this.KmlDataSource=viewer.dataSources.add(Cesium.KmlDataSource.load(t,{camera:viewer.scene.camera,canvas:viewer.scene.canvas,clampToGround:!0})).then((function(t){if(e&&t.entities&&t.entities.values&&t.entities.values.length>0){var i=t.entities.values.filter((function(t){return t.polygon||t.polyline}));e(i,t.name)}})).catch((function(){e()}))}},{key:"handleShpData",value:function(t,e,i){for(var n=this,s=t.geometry.coordinates[0],o=[],a=[],r=[],l=0;l<s.length;l++){var c=s[l];if("GCJ-02"===e){var u=Object(d["f"])(c[0],c[1]);r.push([u[0],u[1]]),o.push({longitude:u[0],latitude:u[1],altitude:c[2]||0}),a.push(Cesium.Cartesian3.fromDegrees(u[0],u[1],c[2]))}else r.push([c[0],c[1]]),o.push({longitude:c[0],latitude:c[1],altitude:c[2]||0}),a.push(Cesium.Cartesian3.fromDegrees(c[0],c[1],c[2]))}var h="",p=null,v=0;"Polygon"===t.geometry.type?(h="polygon",p=Object(d["j"])(Cesium.BoundingSphere.fromPoints(a).center),v=Object(d["l"])(r)):(h="polyline",p=o[0],v=Object(d["n"])(a)),Object(d["d"])({longitude:p.longitude,latitude:p.latitude,altitude:p.altitude>0?p.altitude:0},(function(t){var e={drawingMode:h,labelFont:n.labelFont,activeShapeComputed:v,centerPoint:t,verticesPosition:o,activeSubLine:[],activeShapePoints:o};i&&i(e)}))}},{key:"handleKmlData",value:function(t,e,i){var n=this,s=[],o="";t.polygon?(t.polygon.zIndex=-1,o="polygon",s=t.polygon.hierarchy.getValue(viewer.clock.currentTime).positions):(o="polyline",s=t.polyline.positions.getValue(viewer.clock.currentTime));var a=s.map((function(t){return Object(d["j"])(t)})),r=a;"GCJ-02"===e&&(r=a.map((function(t){var e=Object(d["f"])(t.longitude,t.latitude);return{longitude:e[0],latitude:e[1]}})));for(var l=r.map((function(t){return Cesium.Cartesian3.fromDegrees(t.longitude,t.latitude,t.altitude)})),c=[],u=0;u<r.length;u++){var h=r[u];c.push([h.longitude,h.latitude])}var p=null,v=0,m=[];"polygon"===o?(v=Object(d["l"])(c),p=Object(d["j"])(Cesium.BoundingSphere.fromPoints(l).center)):(p=r[0],v=Object(d["n"])(l),m=Object(d["q"])(r).map((function(t){return{start:t.points[0],end:t.points[1],centerPoint:t.center,distance:t.distance}}))),Object(d["d"])({longitude:p.longitude,latitude:p.latitude,altitude:p.altitude>0?p.altitude:0},(function(t){var e={drawingMode:o,labelFont:n.labelFont,activeShapeComputed:v,centerPoint:t,verticesPosition:r,activeSubLine:m,activeShapePoints:r};i&&i(e)}))}},{key:"getPercentage",value:function(t,e){return 0===t||0===e?0:Math.round(t/e*1e4)/100}},{key:"removeVolumeAnalysisEntity",value:function(t){if(this.VolumeAnalysisEntities.length>0)return Promise.all(this.VolumeAnalysisEntities.map((function(t){viewer.entities.remove(t.entity)}))).then((function(){t&&setTimeout((function(){t(0)}))}));t&&t(1)}},{key:"clearVolumeAnalysisBasePrimitive",value:function(){this.VolumeAnalysisBasePrimitive&&viewer.scene.primitives.remove(this.VolumeAnalysisBasePrimitive)}},{key:"addVolumeAnalysisBasePrimitive",value:function(){this.clearVolumeAnalysisBasePrimitive(),this.VolumeAnalysisBasePrimitive=new Cesium.Primitive({geometryInstances:this.VolumeAnalysisInstances,appearance:new Cesium.PerInstanceColorAppearance({flat:!0})}),viewer.scene.primitives.add(this.VolumeAnalysisBasePrimitive)}},{key:"addVolumeAnalysisPrimitive",value:function(t,e,i){var n=t.pos0,s=t.pos1,o=t.pos2,a=[n._heightPos.longitude,n._heightPos.latitude,n._heightPos.altitude,s._heightPos.longitude,s._heightPos.latitude,s._heightPos.altitude,o._heightPos.longitude,o._heightPos.latitude,o._heightPos.altitude];this.VolumeAnalysisInstances.push(new Cesium.GeometryInstance({geometry:new Cesium.PolygonOutlineGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(a)),extrudedHeight:e,perPositionHeight:!0,closeTop:!0,closeBottom:!0,arcType:Cesium.ArcType.RHUMB,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEXT_FORMAT}),attributes:{color:new Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromRandom()),show:new Cesium.ShowGeometryInstanceAttribute(!0)}}))}},{key:"addVolumeAnalysisEntity",value:function(t,e,i){var n=t.pos0,s=t.pos1,o=t.pos2,a=viewer.entities.add({name:"三角面",parent:this.plotBaseEntity,polygon:{hierarchy:[n.heightPos,s.heightPos,o.heightPos],perPositionHeight:!0,material:Cesium.Color.fromRandom(),extrudedHeight:e,outline:!0,outlineColor:Cesium.Color.WHITE}});this.VolumeAnalysisEntities.push({index:i,entity:a})}},{key:"returnPosition",value:function(t,e){var i=new Cesium.Cartesian3(t[3*e],t[3*e+1],t[3*e+2]),n=Cesium.Cartographic.fromCartesian(i),s=viewer.scene.globe.getHeight(n)>0?viewer.scene.globe.getHeight(n):viewer.scene.sampleHeight(n);return s>this.maxHeigh&&(this.maxHeigh=s),{_heightPos:Object(d["j"])(Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,s)),heightPos:Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,s),noHeightPos:Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,0),height:s}}},{key:"createPolygonGeo",value:function(t,e){var i=Math.PI/Math.pow(2,11)/e,n=new Cesium.PolygonGeometry.fromPositions({positions:t,vertexFormat:Cesium.PerInstanceColorAppearance.FLAT_VERTEX_FORMAT,granularity:i}),s=new Cesium.PolygonGeometry.createGeometry(n),o=s.indices,a={positions:s.attributes.position.values,indices:o};return a}},{key:"VolumeAnalysis",value:function(t,e,i){var n=this;this.removeVolumeAnalysisEntity((function(s){for(var o=0,a=0,r=0,l=0,c=0,u=n.createPolygonGeo(t,i),h=u.indices.length,p=0;p<u.indices.length;p+=3){var v=n.returnPosition(u.positions,u.indices[p]),m=n.returnPosition(u.positions,u.indices[p+1]),f=n.returnPosition(u.positions,u.indices[p+2]);n.addVolumeAnalysisEntity({pos0:v,pos1:m,pos2:f},e,p);var g=Object(d["a"])(v.noHeightPos,m.noHeightPos,f.noHeightPos),y=(v.height+m.height+f.height)/3;if(y<e){r+=g;var C=g*(e-y);l+=C}else if(y===e)c+=g;else{o+=g;var P=g*(y-e);a+=P}n.VolumeAnalysisProgress&&n.VolumeAnalysisProgress(n.getPercentage(p+1,h))}var S=o+r+c,w={allArea:S,cutArea:o,cutVolume:a,fillArea:r,fillVolume:l,noArea:c};n.VolumeAnalysisResult&&(n.VolumeAnalysisResult(w),n.VolumeAnalysisProgress&&n.VolumeAnalysisProgress(n.getPercentage(1,1))),viewer.scene.screenSpaceCameraController.enableCollisionDetection=!0}))}},{key:"VolumeAnalysisV1",value:function(t,e,i){if(e&&(this.extrudedHeightV1=e),t instanceof Array){var n=this.createPolygonGeo(t,i);this._indicesV1=n.indices,this._positionsV1=n.positions}if(this.indexV1<this._indicesV1.length){this.VolumeAnalysisProgress&&this.VolumeAnalysisProgress(this.getPercentage(this.indexV1,this._indicesV1.length));var s=this.returnPosition(this._positionsV1,this._indicesV1[this.indexV1]),o=this.returnPosition(this._positionsV1,this._indicesV1[this.indexV1+1]),a=this.returnPosition(this._positionsV1,this._indicesV1[this.indexV1+2]);this.addVolumeAnalysisPrimitive({pos0:s,pos1:o,pos2:a},this.extrudedHeightV1,this.indexV1);var r=Object(d["a"])(s.noHeightPos,o.noHeightPos,a.noHeightPos),l=(s.height+o.height+a.height)/3;if(l<this.extrudedHeightV1){this.fillAreaV1+=r;var c=r*(this.extrudedHeightV1-l);this.fillVolumeV1+=c}else if(l==this.extrudedHeightV1)this.noAreaV1+=r;else{this.cutAreaV1+=r;var u=r*(l-this.extrudedHeightV1);this.cutVolumeV1+=u}this.indexV1+=3,this._renderFrame=requestAnimationFrame(this.VolumeAnalysisV1.bind(this))}else{var h=this.cutAreaV1+this.fillAreaV1+this.noAreaV1,p={allArea:h||0,cutArea:this.cutAreaV1||0,cutVolume:this.cutVolumeV1||0,fillArea:this.fillAreaV1||0,fillVolume:this.fillVolumeV1||0,noArea:this.noAreaV1||0};this.VolumeAnalysisResult&&(this.VolumeAnalysisResult(p),this.VolumeAnalysisProgress&&(this.addVolumeAnalysisBasePrimitive(),this.VolumeAnalysisProgress(this.getPercentage(1,1)))),this.cancelCalcAnimation()}}},{key:"cancelCalcAnimation",value:function(){window.cancelAnimationFrame(this._renderFrame),this._renderFrame=0,this.indexV1=0,this.cutAreaV1=0,this.cutVolumeV1=0,this.fillAreaV1=0,this.fillVolumeV1=0,this.noAreaV1=0,this.extrudedHeightV1=0,this._indicesV1=void 0,this._positionsV1=void 0}},{key:"SetEventDisabled",value:function(t){this.disabledEvent=t}},{key:"CreateVertex",value:function(t,e,i){if(e){if(-1===e){var n=this.vertexEntities[t];if(!n)return;viewer.entities.remove(n),delete this.vertexEntities[t],this.activeShapePoints.splice(t,1),this.verticesPosition.splice(t,1)}else{var s=this.addButtonEntities[t];if(!s)return;var o=s.position.getValue(viewer.clock.currentTime);"before"===e?(this.activeShapePoints.splice(t,0,o),this.verticesPosition.splice(t,0,o)):"after"===e&&(i&&earthPosition instanceof Cesium.Cartesian3&&(o=i),this.activeShapePoints.splice(t+1,0,o),this.verticesPosition.splice(t+1,0,o))}var a=this.verticesPosition[this.verticesPosition.length-1];if(this.plotting){if(this.activeShapePoints.length>this.verticesPosition.length){var r=this.activeShapePoints[this.activeShapePoints.length-2];this.activeShapePoints.splice(this.activeShapePoints.length-1,1,r)}this.floatingPoint&&this.floatingPoint instanceof Cesium.Entity&&(w(this.floatingPoint,a),this.getMouseCurrentPosition(a))}if("polygon"===this.drawingMode)m(this.activeShape,this.activeShapePoints),this.drawAreaLabel();else if("polyline"===this.drawingMode){var l=Object.keys(this.distanceLabelEntities);l.length>0&&(viewer.entities.remove(this.distanceLabelEntities[l.length-1]),delete this.distanceLabelEntities[l.length-1],l.pop(),this.createDistanceLabel(l.length-1,a,0)),this.drawLineLabel()}"pc"===this.platform||this.setFinishPointPosition(a),this.setVerticesNewIndex(),this.setVerticesPositionValue(),this.removeDeleteVertexButtonEntity(),this.plotting||this.terminateShape()}}},{key:"SetGraphicNewStyle",value:function(t){var e=t.text,i=t.colorValue,n=t.font;this.labelFont=n||"30px sans-serif",this.plotName=e,this.colorValue=i;var s=this.colorValue||"#17E980",o=s?new Cesium.Color.fromCssColorString(s):new Cesium.Color.fromCssColorString("#17E980");for(var a in this.vertexEntities)if(Object.hasOwnProperty.call(this.vertexEntities,a)){var r=this.vertexEntities[a];E(r,new Cesium.Color.fromCssColorString(s)),"point"===this.drawingMode?S(r,p("point",{name:this.plotName})):"text"===this.drawingMode&&(P(r,this.labelFont),C(r,o),S(r,p("point",{name:this.plotName||"请输入文本内容"})))}"polyline"===this.drawingMode?(y(this.activeShape,new Cesium.Color.fromCssColorString(s)),S(this.totalDistanceLabelEntity,p("polyline",{name:this.plotName,value:this.activeShapeComputed}))):"polygon"===this.drawingMode&&(f(this.activeShape,new Cesium.Color.fromCssColorString(s)),S(this.areaLabelEntity,p("polygon",{name:this.plotName,value:this.activeShapeComputed})))}},{key:"AddEditPlotData",value:function(t){var e=this,i=[],n=[];t.objectInfo.activeShapePoints&&t.objectInfo.activeShapePoints.length>0&&(i=t.objectInfo.activeShapePoints.map((function(t){return Cesium.Cartesian3.fromDegrees(t.longitude,t.latitude,t.altitude)}))),t.objectInfo.verticesPosition&&t.objectInfo.verticesPosition.length>0&&(n=t.objectInfo.verticesPosition.map((function(t){return Cesium.Cartesian3.fromDegrees(t.longitude,t.latitude,t.altitude)})));var s=t.objectInfo.centerPoint,o=Cesium.Cartesian3.fromDegrees(s.longitude,s.latitude,s.altitude);this.plotName=t.towerName,this.drawingMode=t.objectInfo.drawingMode,this.colorValue=t.objectInfo.colorValue.hex8,this.labelFont=t.objectInfo.labelFont,this.activeShapeComputed=t.objectInfo.activeShapeComputed,this.activeSubLine=t.objectInfo.activeSubLine,this.activeShapePoints=i,this.verticesPosition=n,this.activeShape=this.drawShape(this.verticesPosition),this.setVerticesPositionValue(),n.length>0&&n.length<50&&n.map((function(t,i){var n="".concat(e.drawingMode,"_vertices_").concat(i,"_").concat(e.ID);e.vertexEntities[i]=e.createPoint(t,n)})),"polygon"===this.drawingMode?this.areaLabelEntity=this.createAreaLabel(o,this.activeShapeComputed):"polyline"===this.drawingMode&&this.activeSubLine.length>0&&(this.activeSubLine.map((function(t,i){e.createPlottingDistanceLabel(i,Cesium.Cartesian3.fromDegrees(t.centerPoint.longitude,t.centerPoint.latitude,t.centerPoint.altitude),t.distance)})),this.setTotalDistancePositionAndLabel(this.activeShapePoints[0],this.activeShapeComputed)),this.terminateShape()}},{key:"ChangeVertexPosition",value:function(t){var e=new Cesium.Cartesian3.fromDegrees(t.longitude,t.latitude,t.altitude);w(this.vertexEntities[parseInt(this.editEntityId.split("_")[2])],e),"polygon"===this.drawingMode?this.setPolygonNewShape(this.activeShape,e):"polyline"===this.drawingMode?(this.setPolylineNewShape(this.activeShape,e),this.drawLineLabel()):this.setPointNewShap(e),this.terminateShape()}},{key:"ContinueDrawing",value:function(t){if(t){var e=Cesium.Cartesian3.fromDegrees(parseFloat(t.longitude),parseFloat(t.latitude),parseFloat(t.altitude)),i=Object(d["g"])(t);this.leftClickAction({position:i},e)}}},{key:"FlyToPosition",value:function(t,e){viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(t.longitude,t.latitude,1e3),orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0},duration:1,complete:function(){e&&e()}})}},{key:"SetEditVertexId",value:function(t){var e="".concat(this.drawingMode,"_vertices_").concat(t,"_").concat(this.ID);"polyline"!==this.drawingMode&&"polygon"!==this.drawingMode||this.removeDeleteVertexButtonEntity();var i=this.vertexEntities[parseInt(this.editEntityId.split("_")[2])];i&&i instanceof Cesium.Entity&&b(i,14),this.editEntityId=e,this.CurrentEditVertice&&this.CurrentEditVertice(this.editEntityId);var n=parseInt(this.editEntityId.split("_")[2]);if(n>-1){var s=this.vertexEntities[n];s&&(b(s,24),"pc"!==this.platform||"polyline"!==this.drawingMode&&"polygon"!==this.drawingMode||this.setDeleteVertexButtonEntityPosition(s.position.getValue(viewer.clock.currentTime)))}}},{key:"StopPlot",value:function(){this.plotting=!1,viewer._container.style.cursor="default",this.PlottingStatus&&this.PlottingStatus(!1)}},{key:"StartPlot",value:function(t){this.Init(),t&&(this.drawingMode=t),this.plotting=!0,viewer._container.style.cursor="crosshair",this.PlottingStatus&&this.PlottingStatus(!0)}},{key:"setVerticesNewIndex",value:function(){var t=this;for(var e in this.vertexEntities)if(Object.hasOwnProperty.call(this.vertexEntities,e)){var i=this.vertexEntities[e];viewer.entities.remove(i),delete this.vertexEntities[e]}this.verticesPosition.map((function(e,i){var n="".concat(t.drawingMode,"_vertices_").concat(i,"_").concat(t.ID);t.vertexEntities[i]=t.createPoint(t.verticesPosition[i],n)}))}},{key:"createAddButtonEntity",value:function(t,e){var i=null,n="addButton_".concat(t,"_").concat(this.ID);return this.addButtonEntities[t]?(i=this.addButtonEntities[t],w(i,e)):i=viewer.entities.add({name:"plot",position:e,parent:this.plotBaseEntity,id:n,point:{color:Cesium.Color.WHITE,pixelSize:12,show:!this.plotting}}),i}},{key:"ResetAddButtonEntities",value:function(){var t=this;if(!(this.verticesPosition.length>50)){var e=this.verticesPosition.filter((function(t){return t}));if("polygon"===this.drawingMode){var i=e[0];e.push(i)}var n=Object(d["i"])(e);for(var s in this.addButtonEntities)if(Object.hasOwnProperty.call(this.addButtonEntities,s)){var o=this.addButtonEntities[s];viewer.entities.remove(o),delete this.addButtonEntities[s]}n.map((function(e,i){t.addButtonEntities[i]=t.createAddButtonEntity(i,e.center)}))}}},{key:"setVerticesPositionValue",value:function(){if(this.VerticesFinish){var t=this.verticesPosition.filter((function(t){return t})).map((function(t){return Object(d["j"])(t)}));this.VerticesFinish(t)}this.ResetAddButtonEntities()}},{key:"getMouseCurrentPosition",value:function(t){var e=new window.Cesium.Cartesian2,i=viewer.scene.cartesianToCanvasCoordinates(t,e);if(window.Cesium.defined(i)){var n={map:Object(d["j"])(t),screen:i};this.MousePosition&&this.MousePosition(n)}}},{key:"clearAllPlotEntity",value:function(){if(this.plotBaseEntity){if(this.plotBaseEntity._children&&this.plotBaseEntity._children.length>0)for(var t=this.plotBaseEntity._children,e=0;e<t.length;e++){var i=t[e];viewer.entities.remove(i)}viewer.entities.remove(this.plotBaseEntity)}}},{key:"addPlotBaseEntity",value:function(){var t="plotBaseEntity_".concat(this.ID);viewer.entities.remove(viewer.entities.getById(t)),this.plotBaseEntity=new Cesium.Entity({id:t,show:!0,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND}),viewer.entities.add(this.plotBaseEntity)}},{key:"terminateShape",value:function(){viewer._container.style.cursor="default",this.activeShapePoints.length>this.verticesPosition.length&&this.activeShapePoints.pop();var t=Object.keys(this.distanceLabelEntities);if(this.activeShapePoints.length===t.length){var e=t[t.length-1];viewer.entities.remove(this.distanceLabelEntities[e]),delete this.distanceLabelEntities[e],this.activeSubLine.pop()}this.drawShape(this.activeShapePoints);var i=this.activeShapePoints[0];"polygon"===this.drawingMode&&(i=Object(d["m"])(this.activeShape));var n=Object(d["j"])(i),s=this.activeShapePoints.filter((function(t){return t})).map((function(t){return Object(d["j"])(t)})),o=this.verticesPosition.filter((function(t){return t})).map((function(t){return Object(d["j"])(t)}));this.Finish&&this.Finish({drawingMode:this.drawingMode,labelFont:this.labelFont,activeShapeComputed:this.activeShapeComputed,centerPoint:n,verticesPosition:o,activeSubLine:this.activeSubLine,activeShapePoints:s}),viewer.entities.remove(this.finishPointEntity),this.finishPointEntity=null,viewer.entities.remove(this.floatingPoint),this.floatingPoint=null,this.StopPlot(),this.ResetAddButtonEntities()}},{key:"setPointNewShap",value:function(t){this.verticesPosition=[t],this.activeShapePoints=[t],this.setVerticesPositionValue()}},{key:"setPolylineNewShape",value:function(t,e){var i=parseInt(this.editEntityId.split("_")[2]),n=t.polyline.positions.getValue(viewer.clock.currentTime);n.splice(i,1,e),this.verticesPosition.splice(i,1,e),this.activeShapePoints=n,g(t,n),this.drawLineLabel(),this.setVerticesPositionValue()}},{key:"setPolygonNewShape",value:function(t,e){var i=Object.assign({x:e.x,y:e.y,z:e.z}),n=new Cesium.Cartesian3(i.x,i.y,i.z),s=parseInt(this.editEntityId.split("_")[2]),o=t.polygon.hierarchy.getValue(viewer.clock.currentTime).positions;o.splice(s,1,e),this.verticesPosition.splice(s,1,n),this.activeShapePoints=o,m(t,o),this.drawAreaLabel(),this.setVerticesPositionValue()}},{key:"setDeleteVertexButtonEntityPosition",value:function(t){this.deleteVertexButtonEntity?w(this.deleteVertexButtonEntity,t):this.deleteVertexButtonEntity=this.createDeleteVertexButtonEntity(t)}},{key:"removeDeleteVertexButtonEntity",value:function(){viewer.entities.remove(this.deleteVertexButtonEntity),this.deleteVertexButtonEntity=null}},{key:"createDeleteVertexButtonEntity",value:function(t){var e=null;if(this.deleteVertexButtonEntity)e=this.deleteVertexButtonEntity;else{var n="deleteVertexButton_".concat(this.ID);e=viewer.entities.add(new Cesium.Entity({id:n,name:"plot",parent:this.plotBaseEntity,position:t,billboard:{image:i("4da0"),scale:1,pixelOffset:new Cesium.Cartesian2(0,-30),color:Cesium.Color.RED,show:!0}}))}return e}},{key:"setFinishPointPosition",value:function(t){this.finishPointEntity&&this.finishPointEntity instanceof Cesium.Entity?w(this.finishPointEntity,t):this.finishPointEntity=this.createFinishPoint(t)}},{key:"createFinishPoint",value:function(t){var e=null;if(this.finishPointEntity&&this.finishPointEntity instanceof Cesium.Entity)e=this.finishPointEntity;else{var n="finishPoint_".concat(this.ID);e=this.finishPointEntity=viewer.entities.add({id:n,position:t,name:"plot",parent:this.plotBaseEntity,billboard:{image:i("a99a"),verticalOrigin:Cesium.VerticalOrigin.CENTER,horizontalOrigin:Cesium.HorizontalOrigin.BOTTOM,scale:.5,eyeOffset:new Cesium.Cartesian3(0,0,-10),show:!0}})}return e}},{key:"createPoint",value:function(t,e){if("pc"!==this.platform&&("polyline"===this.drawingMode||"polygon"===this.drawingMode)){var i=!1;"polyline"===this.drawingMode?this.verticesPosition.length>=2&&(i=!0):this.verticesPosition.length>=3&&(i=!0),i&&this.setFinishPointPosition(t)}var n=this.colorValue?Cesium.Color.fromCssColorString(this.colorValue):Cesium.Color.RED;if("text"===this.drawingMode){var s=p("text",{name:this.plotName||"请输入文本内容"}),o=viewer.entities.add({position:t,name:"plot",parent:this.plotBaseEntity,label:{text:s,font:this.labelFont,fillColor:n,disableDepthTestDistance:Number.POSITIVE_INFINITY,scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5),show:!0}});return o}if("polyline"===this.drawingMode||"polygon"===this.drawingMode){if(this.vertexEntities[parseInt(e.split("_")[2])])return;var a=viewer.entities.add({position:t,name:"plot",parent:this.plotBaseEntity,id:e,point:{color:n,pixelSize:14,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#fff")}});return a}var r=p("text",{name:this.plotName});if(this.pointPositionVisible){var l=Object(d["j"])(t);r=p("point",l)}if(viewer.entities.getById(e)){var c=viewer.entities.getById(e);return w(c,t),S(c,r),c}var u=viewer.entities.add({position:t,name:"plot",parent:this.plotBaseEntity,id:e,point:{color:n,pixelSize:14,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#fff")},label:{text:r,font:this.labelFont,pixelOffset:new Cesium.Cartesian2(0,40),fillColor:Cesium.Color.fromCssColorString("#fff"),style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#000"),disableDepthTestDistance:Number.POSITIVE_INFINITY,scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5),show:!0}});return u}},{key:"drawShape",value:function(t){var e=this.colorValue?Cesium.Color.fromCssColorString(this.colorValue):Cesium.Color.RED,i=this.colorValue?Cesium.Color.fromCssColorString(this.colorValue):Cesium.Color.WHITE.withAlpha(.6),n=null;if("polyline"===this.drawingMode){var s="plotPolyline_".concat(this.ID);viewer.entities.getById(s)?(n=viewer.entities.getById(s),g(n,t)):n=viewer.entities.add({id:s,name:"plot",parent:this.plotBaseEntity,polyline:{positions:t,material:e,depthFailMaterial:new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.WHITE.withAlpha(.6)}),width:5}})}else if("polygon"===this.drawingMode){var o="plotPolygon_".concat(this.ID);viewer.entities.getById(o)?(n=viewer.entities.getById(o),m(n,t)):n=viewer.entities.add({id:o,name:"plot",parent:this.plotBaseEntity,polygon:{hierarchy:t,zIndex:999,material:new Cesium.ColorMaterialProperty(i)}})}return n}},{key:"setTotalDistancePositionAndLabel",value:function(t,e){var i=p("polyline",{name:this.plotName,value:e});this.totalDistanceLabelEntity?(w(this.totalDistanceLabelEntity,t),S(this.totalDistanceLabelEntity,i)):this.totalDistanceLabelEntity=this.createTotalDistanceLabel(t,i)}},{key:"createTotalDistanceLabel",value:function(t,e){var i=null;if(this.totalDistanceLabelEntity)i=this.totalDistanceLabelEntity;else{var n="plotPolylineTotal_".concat(this.ID);i=viewer.entities.add({id:n,position:t,name:"plot",parent:this.plotBaseEntity,label:{text:e,font:"30px sans-serif",pixelOffset:new Cesium.Cartesian2(0,20),fillColor:Cesium.Color.fromCssColorString("#fff"),style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#000"),disableDepthTestDistance:Number.POSITIVE_INFINITY,scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5),show:!0}})}return i}},{key:"createDistanceLabel",value:function(t,e,i){var n=null,s="distanceLabel_".concat(t,"_").concat(this.ID),o=p("polyline",{subValue:i});return this.distanceLabelEntities[t]?(n=this.distanceLabelEntities[t],w(n,e),S(n,o)):n=viewer.entities.add({id:s,name:"plot",position:e,parent:this.plotBaseEntity,label:{text:o,font:"30px sans-serif",pixelOffset:new Cesium.Cartesian2(0,20),fillColor:Cesium.Color.fromCssColorString("#fff"),style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#000"),disableDepthTestDistance:Number.POSITIVE_INFINITY,scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5),show:!0}}),n}},{key:"createPlottingDistanceLabel",value:function(t,e,i){this.distanceLabelEntities[t]=this.createDistanceLabel(t,e,i)}},{key:"drawLineDistanceLabel",value:function(){if(this.editEntityId){var t=parseInt(this.editEntityId.split("_")[2]),e=this.vertexEntities[t],i=this.vertexEntities[t-1],n=this.vertexEntities[t+1],s=this.distanceLabelEntities[t-1],o=this.distanceLabelEntities[t];if(s){var a=this.addButtonEntities[t-1],r=a.position.getValue(viewer.clock.currentTime),l=Object(d["e"])(e.position.getValue(viewer.clock.currentTime),i.position.getValue(viewer.clock.currentTime));this.createDistanceLabel(t-1,r,l)}if(o){var c=this.addButtonEntities[t],u=c.position.getValue(viewer.clock.currentTime),h=Object(d["e"])(e.position.getValue(viewer.clock.currentTime),n.position.getValue(viewer.clock.currentTime));this.createDistanceLabel(t,u,h)}this.activeShapeComputed=Object(d["n"])(this.activeShapePoints),this.setTotalDistancePositionAndLabel(this.activeShapePoints[0],this.activeShapeComputed)}}},{key:"drawLineLabel",value:function(){var t=this;if(this.activeShapePoints&&this.activeShapePoints.length>0){var e=this.activeShapePoints.map((function(t){return Object(d["j"])(t)})),i=Object(d["q"])(e),n=i.map((function(t){return{start:t.points[0],end:t.points[1],distance:t.distance,centerPoint:t.center}}));this.activeSubLine=n,this.activeSubLine.map((function(e,i){if(e.start&&e.end){var n=new Cesium.Cartesian3.fromDegrees(e.centerPoint.longitude,e.centerPoint.latitude,e.centerPoint.altitude),s=e.distance;n&&s&&t.createPlottingDistanceLabel(i,n,s)}})),this.activeShapeComputed=Object(d["n"])(this.activeShapePoints),this.setTotalDistancePositionAndLabel(this.activeShapePoints[0],this.activeShapeComputed)}}},{key:"createAreaLabel",value:function(t,e){var i=this.verticesPosition.filter((function(t){return t})).map((function(t){return Object(d["j"])(t)})).map((function(t){return t.altitude})),n=i.sort()[i.length-1],s=Object(d["j"])(t),o=Cesium.Cartesian3.fromDegrees(s.longitude,s.latitude,n),a=p("polygon",{name:this.plotName,value:e}),r=null,l="plotPolygonTotal_".concat(this.ID);return viewer.entities.getById(l)?(r=viewer.entities.getById(l),w(r,o),S(r,a)):r=viewer.entities.add({id:l,position:o,name:"plot",parent:this.plotBaseEntity,label:{text:a,font:"30px sans-serif",fillColor:Cesium.Color.fromCssColorString("#fff"),style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#000"),disableDepthTestDistance:Number.POSITIVE_INFINITY,scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5),show:!0}}),r}},{key:"drawAreaLabel",value:function(){if(this.activeShapePoints&&this.activeShapePoints.length>1){var t=Object(d["m"])(this.activeShape),e=[],i=this.activeShapePoints.map((function(t){return Object(d["j"])(t)})),n=i[0];i.push(n);for(var s=0;s<i.length;s++){var o=i[s];e.push([o.longitude,o.latitude])}this.activeShapeComputed=parseFloat(Object(d["l"])(e)).toFixed(2),t&&this.activeShapeComputed&&(this.areaLabelEntity=this.createAreaLabel(t,this.activeShapeComputed))}}},{key:"leftUpAction",value:function(){this.leftDownFlag&&this.editEntityId&&(this.leftDownFlag=!1,viewer._container.style.cursor="default",viewer.scene.screenSpaceCameraController.enableRotate=!0,this.terminateShape())}},{key:"leftDownAction",value:function(t){if(this.editEntityId){var e=viewer.scene.pick(t.position);if(e&&e.id&&e.id instanceof Cesium.Entity){var i=e.id;i.id===this.editEntityId&&(this.startMovePoint=t.position,this.leftDownFlag=!0,this.startMoveHeight=Cesium.Cartographic.fromCartesian(i.position.getValue(viewer.clock.currentTime)).height,viewer._container.style.cursor="move",this.pickedEntity=i,viewer.scene.screenSpaceCameraController.enableRotate=!1)}else this.leftUpAction(t)}}},{key:"rightClickAction",value:function(){var t=!1,e="";this.plotting&&("point"===this.drawingMode||"text"===this.drawingMode?this.verticesPosition.length<1&&(t=!0,e="请至少绘制一个点！"):"polyline"===this.drawingMode?this.verticesPosition.length<2&&(t=!0,e="请至少绘制两个点！"):"polygon"===this.drawingMode&&this.verticesPosition.length<3&&(t=!0,e="请至少绘制三个点！")),t&&e?A["Message"].error({customClass:"message_new_style",message:e}):this.plotting&&this.terminateShape()}},{key:"mouseMoveAction",value:function(t,e){var i=null;if(e&&e instanceof Cesium.Cartesian3)i=e;else try{i=Object(d["c"])(t.endPosition).earthPosition}catch(m){}if(i)if(viewer._container.style.cursor="default",this.plotting)this.getMouseCurrentPosition(i),viewer._container.style.cursor="crosshair",Cesium.defined(this.floatingPoint)&&Cesium.defined(i)&&(w(this.floatingPoint,i),this.activeShapePoints.pop(),this.activeShapePoints.push(i),"polygon"===this.drawingMode?this.drawAreaLabel():"polyline"===this.drawingMode&&this.drawLineLabel());else if(this.leftDownFlag&&this.editEntityId){viewer._container.style.cursor="move";var n=null;if(this.overlookStatus){var s=viewer.camera.getPickRay(t.endPosition),o=viewer.scene.globe.pick(s,viewer.scene),a=Object(d["j"])(o),r=new Cesium.Cartesian3.fromDegrees(a.longitude,a.latitude,this.startMoveHeight);n=r}else{if(!this.startMovePoint)return;var l=t.endPosition.y-this.startMovePoint.y,c=Object(d["j"])(this.pickedEntity.position.getValue(viewer.clock.currentTime));this.pickedEntityHeight=this.startMoveHeight-l/10,this.pickedEntityHeight<0&&(this.pickedEntityHeight=0),n=new Cesium.Cartesian3.fromDegrees(c.longitude,c.latitude,this.pickedEntityHeight)}"pc"!==this.platform||"polyline"!==this.drawingMode&&"polygon"!==this.drawingMode||this.setDeleteVertexButtonEntityPosition(n);var u=this.vertexEntities[parseInt(this.editEntityId.split("_")[2])];if(w(u,n),this.pointPositionVisible){var h=p("point",Object(d["j"])(n));S(u,h)}"polygon"===this.drawingMode?this.setPolygonNewShape(this.activeShape,n):"polyline"===this.drawingMode?this.setPolylineNewShape(this.activeShape,n):this.setPointNewShap(n)}else{var v=viewer.scene.pick(t.endPosition);v&&v.id&&v.id instanceof Cesium.Entity&&v.id.name&&"plot"===v.id.name&&(viewer._container.style.cursor="pointer")}}},{key:"leftClickAction",value:function(t,e){var i=this;if(this.plotting){var n=Object(d["c"])(t.position),s=null,o=!1;if("pc"===this.platform&&(o=!0),e&&e instanceof Cesium.Cartesian3)s=e,o=!1;else if(s=n.earthPosition,n.pickModel&&n.pickModel.id&&this.finishPointEntity&&this.finishPointEntity.id===n.pickModel.id.id)return void this.rightClickAction();if(!s)return;var a=this,r=Object.assign({x:s.x,y:s.y,z:s.z}),l=new Cesium.Cartesian3(r.x,r.y,r.z);if(this.verticesPosition.push(l),this.getMouseCurrentPosition(s),this.setVerticesPositionValue(),Cesium.defined(s)){if(0===this.activeShapePoints.length){if(o){this.activeShapePoints.push(s);var c="".concat(this.drawingMode,"_vertices_floating_").concat(this.ID);this.floatingPoint=this.createPoint(s,c)}var u=new Cesium.CallbackProperty((function(){return"polygon"===a.drawingMode?new Cesium.PolygonHierarchy(a.activeShapePoints):"polyline"===a.drawingMode?a.activeShapePoints:void 0}),!1);this.activeShape=this.drawShape(u)}this.activeShapePoints.push(s);var h="".concat(this.drawingMode,"_vertices_").concat(this.activeShapePoints.length-1,"_").concat(this.ID);this.activeShapePoints.length>this.verticesPosition.length&&(h="".concat(this.drawingMode,"_vertices_").concat(this.activeShapePoints.length-2,"_").concat(this.ID)),"polygon"===this.drawingMode?this.drawAreaLabel():"polyline"===this.drawingMode?this.drawLineLabel():this.terminateShape(),this.vertexEntities[parseInt(h.split("_")[2])]=this.createPoint(s,h)}}else{var p=viewer.scene.pick(t.position);if(p&&p.id&&p.id instanceof Cesium.Entity){var v=p.id.id;if(v.indexOf("_vertices")>-1)this.SetEditVertexId(parseInt(v.split("_")[2]));else if(v.indexOf("deleteVertexButton")>-1){var m=parseInt(this.editEntityId.split("_")[2]);A["MessageBox"].confirm("是否删除顶点".concat(m+1),"提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){var t=!1,e="";"polyline"===i.drawingMode?i.verticesPosition.length<=2&&(t=!0,e="请至少保留两个点！"):"polygon"===i.drawingMode&&i.verticesPosition.length<=3&&(t=!0,e="请至少保留三个点！"),t&&e?A["Message"].error({customClass:"message_new_style",message:e}):i.CreateVertex(m,-1)}))}else if(v.indexOf("addButton")>-1){var f=parseInt(v.split("_")[1]);this.CreateVertex(f,"after")}}}}},{key:"removeInputActionFun",value:function(){this.eventHandler&&(this.eventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK),this.eventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this.eventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOWN),this.eventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_UP),this.eventHandler.removeInputAction(Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.eventHandler.removeInputAction(Cesium.ScreenSpaceEventType.RIGHT_CLICK))}},{key:"initInputActionFun",value:function(){var t=this;this.removeInputActionFun(),this.eventHandler=new Cesium.ScreenSpaceEventHandler(viewer.scene.canvas),this.eventHandler.setInputAction((function(e){t.disabledEvent||t.leftClickAction(e)}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.eventHandler.setInputAction((function(e){t.disabledEvent||"pc"!==t.platform&&t.rightClickAction()}),Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this.eventHandler.setInputAction((function(e){t.disabledEvent||t.leftDownAction(e)}),Cesium.ScreenSpaceEventType.LEFT_DOWN),this.eventHandler.setInputAction((function(e){t.disabledEvent||t.leftUpAction(e)}),Cesium.ScreenSpaceEventType.LEFT_UP),this.eventHandler.setInputAction((function(e){t.disabledEvent||t.mouseMoveAction(e)}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.eventHandler.setInputAction((function(e){t.disabledEvent||t.rightClickAction()}),Cesium.ScreenSpaceEventType.RIGHT_CLICK)}},{key:"Init",value:function(){this.Destory(),this.initInputActionFun(),this.addPlotBaseEntity()}},{key:"Destory",value:function(){viewer.entities.remove(this.floatingPoint),viewer.entities.remove(this.activeShape),viewer.entities.remove(this.finishPointEntity),viewer.entities.remove(this.startMovePoint),viewer.entities.remove(this.pickedEntity),this.floatingPoint=null,this.activeShape=null,this.finishPointEntity=null,this.startMovePoint=null,this.pickedEntity=null,this.overlookStatus=!0,this.activeShapeComputed=0,this.labelFont="30px sans-serif",this.plotName="",this.activeShapePoints=[],this.activeSubLine=[],this.verticesPosition=[],this.editEntityId="",this.currentEditPolygonTopPoint=null,this.areaLabelEntity=null,this.distanceLabelEntities={},this.vertexEntities={},this.addButtonEntities={},this.totalDistanceLabelEntity=null,this.leftDownFlag=!1,this.startMoveHeight=0,this.pickedEntityHeight=0,this.VolumeAnalysisInstances=[],this.StopPlot(),this.removeInputActionFun(),this.clearAllPlotEntity(),this.setVerticesPositionValue(),this.clearVolumeAnalysisBasePrimitive(),this.removeKmlDataSource()}}]),t}(),I={data:function(){return{$PlotUtil:null,active:"",btns:[{name:"point"},{name:"polyline"},{name:"polygon"}]}},computed:{},watch:{},mounted:function(){window.$InitMap();var t=new Cesium.Cesium3DTileset({url:"https://lab.earthsdk.com/model/f15b9e90ac2d11e99dbd8fd044883638/tileset.json",debugShowMemoryUsage:!1});viewer.scene.primitives.add(t),viewer.zoomTo(t),this.initPlotUtil()},methods:{DecryptPlotData:function(t){if(t){var e=JSON.parse(JSON.stringify(t));if(e.objectInfo)try{var i=JSON.parse(e.objectInfo);if(i&&"object"===c(i)){if(e.objectInfo=i,i.activeShapePoints&&i.activeShapePoints.length>0){var n=i.activeShapePoints.map((function(t){return{longitude:t.longitude-180,latitude:t.latitude-90,altitude:t.altitude}}));i.activeShapePoints=n}if(i.verticesPosition&&i.verticesPosition.length>0){var s=i.verticesPosition.map((function(t){return{longitude:t.longitude-180,latitude:t.latitude-90,altitude:t.altitude}}));i.verticesPosition=s}if(i.activeSubLine&&i.activeSubLine.length>0){var o=i.activeSubLine.map((function(t){return{start:{longitude:t.start.longitude-180,latitude:t.start.latitude-90,altitude:t.start.altitude},end:{longitude:t.end.longitude-180,latitude:t.end.latitude-90,altitude:t.end.altitude},distance:t.distance,centerPoint:{longitude:t.centerPoint.longitude-180,latitude:t.centerPoint.latitude-90,altitude:t.centerPoint.altitude}}}));i.activeSubLine=o}if(i.centerPoint){var a={longitude:i.centerPoint.longitude-180,latitude:i.centerPoint.latitude-90,altitude:i.centerPoint.altitude};i.centerPoint=a}}}catch(r){}return e}},addGraphic:function(t){if("point"===t.drawingMode)viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(t.centerPoint.longitude,t.centerPoint.latitude,t.centerPoint.altitude),point:{color:new Cesium.Color.fromCssColorString("#17E980"),scaleByDistance:new Cesium.NearFarScalar(100,1,7e3,.8),pixelSize:14,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#fff")},label:{text:"经度：".concat(t.centerPoint.longitude,"\n纬度：").concat(t.centerPoint.latitude,"\n海拔：").concat(t.centerPoint.altitude),font:"30px sans-serif",fillColor:Cesium.Color.fromCssColorString("#fff"),style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#000"),disableDepthTestDistance:Number.POSITIVE_INFINITY,scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5)}});else if("polyline"===t.drawingMode){if(viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(t.centerPoint.longitude,t.centerPoint.latitude,t.centerPoint.altitude),label:{text:"".concat(t.activeShapeComputed,"m"),font:"30px sans-serif",fillColor:Cesium.Color.fromCssColorString("#fff"),style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#000"),disableDepthTestDistance:Number.POSITIVE_INFINITY,scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5)}}),t.activeSubLine&&t.activeSubLine.length>0){var e=Cesium.Color.fromCssColorString("#17E980");t.activeSubLine.map((function(t,i){if(!(t.distance<=0)){var n=Cesium.Cartesian3.fromDegreesArrayHeights([t.start.longitude,t.start.latitude,t.start.altitude,t.end.longitude,t.end.latitude,t.end.altitude]);viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(t.centerPoint.longitude,t.centerPoint.latitude,t.centerPoint.altitude),polyline:{positions:n,material:e,depthFailMaterial:new Cesium.PolylineDashMaterialProperty({_polylineColor:e}),width:5},label:{text:"".concat(t.distance,"米"),font:"30px sans-serif",fillColor:Cesium.Color.fromCssColorString("#fff"),style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#000"),disableDepthTestDistance:Number.POSITIVE_INFINITY,scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5)}})}}))}}else if("polygon"===t.drawingMode){var i=t.verticesPosition||t.activeShapePoints||[],n=[];if(i.length>0&&i.map((function(t){n.push(Cesium.Cartesian3.fromDegrees(t.longitude,t.latitude,t.altitude))})),n.length>0){var s=new Cesium.CallbackProperty((function(){return new Cesium.PolygonHierarchy(n)}),!1),o=t.centerPoint,a=i.map((function(t){return t.altitude})),r=a.sort()[a.length-1];o.altitude=r;var l=Cesium.Color.fromCssColorString("#17E980");viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(t.centerPoint.longitude,t.centerPoint.latitude,t.centerPoint.altitude),polygon:{hierarchy:s,material:new Cesium.ColorMaterialProperty(l)},label:{text:"".concat(t.activeShapeComputed,"平方米"),font:"30px sans-serif",fillColor:Cesium.Color.fromCssColorString("#fff"),style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineWidth:2,outlineColor:Cesium.Color.fromCssColorString("#000"),disableDepthTestDistance:Number.POSITIVE_INFINITY,scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5)}})}}else if("text"===t.drawingMode){var c=Cesium.Color.fromCssColorString("#17E980");viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(t.centerPoint.longitude,t.centerPoint.latitude,t.centerPoint.altitude),label:{text:text,font:_font,fillColor:c,disableDepthTestDistance:Number.POSITIVE_INFINITY,distanceDisplayCondition:new Cesium.DistanceDisplayCondition(0,3e4),scaleByDistance:new Cesium.NearFarScalar(100,.6,7e3,.5),show:visible}})}},initPlotUtil:function(){var t=this;this.$PlotUtil=new V({defaultColorValue:"#17E980",PlottingStatus:function(t){},Finish:function(e){t.addGraphic(e)},VerticesFinish:function(t){},CurrentEditVertice:function(t){}})},handleClick:function(t){this.active=this.active===t.name?this.active="":this.active=t.name,this.active?this.$PlotUtil.StartPlot(this.active):this.$PlotUtil.Destory()}}},L=I,D=(i("ec9e"),i("2877")),x=Object(D["a"])(L,n,s,!1,null,"63da6814",null);e["default"]=x.exports},a99a:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAASESURBVHic7Zu/T1tXFMc/x/SH5KHxzBChZMmC3IiKDk0iIgaClMGKUiohBrczSOA/AIkMWSKZSh4rpQzIqIA6ZShTJQpCVQsN8lIGF6sLK8lgkmL3dLjP1Dz8473n98MGvovld+8793yO732+795zhYClqneBB8AAcM/6/AT4EJBaNeAUeAuUgC3rc1NE/gjaR9+lqhOq+lJVj7VzHVu2JqLmailVvamqL3yCbhWMF6p6M2reM6nqgPULnQYIbtep1eZA1PDPVfVdiOB2vVPV51GAD6lqMUJwu4qqOhQW/LyqViIGbqSKqs4HCS6quhYxpBOtqaq0JzJyVFFVE8Ar4AuvAQxZ28BjETluV7FtACz4n4FPfXAsTL0GHrYLQssAWF3pF3rnl7drG7gvItqsQqyNgVV6Fx6M76utKjQNgJon6lO/PYpAT7XFv0PDIaDmP/VXoC8or0JWFfhcRHbtBc0CUARuBe1VyPpLRG7bL14YAmqmlpcNHuCWNpg2n+sBal4u/gQ+DsmpsPUeuCMipdoFew+Y5/LCg2E790A86wFq3rGLwAchOxW2KsBtEfkbzveAGS4/PBjGmdqX+h5wDNyIwiM32tnZYWVlhcPDQ/r7+0mlUoyPj7s180ZEEmAFQM162w8+++q78vk82Wz2wvWpqSlmZ2fdmvtKRFZrQ+BRp84FrWbwAMvLyxwcHLg1+Qj+fwY88e5a8GoFX9PW1pZbs08AYmrW7bt27DuBByiXy25N31DVuzHMpkVXyik8wODgoJcmHsQwOzVdJzfwQ0NDjIyMeGlmIIbZruoquYFPJpMsLi56beqeLz3g6OiIYrFItVrt1JRr+FwuRzwe99rcgKjqe+AjL3cXCgUWFhYolUoAJBIJpqenSaVSnrwJGR7gH1HVf3G4OlyvYrFIOp3m5OTkQlkmk2FyctKVvQjgATSGB3iApaWlhvAA2WyWfD7v2FZE8ADSblG0qQqFQstyp0GIEB4wM8GmS8at5MSJdkGIGh5rCJx6uXN0dNRRvWZB6AJ4gNMYJi3FtdLpNMlk0lFdexC6BB7grajqb8BnXu4ul8vMzMywv7/vqH4mkwHoFniA30VVFwHXL9M1uQ2CU4UAD/BtDJON5VnxeJxcLud4ODhRSPAApRiw2akVP4MQIjzAZm1JzJf1wE6HQ8jwb0QkUZsI/eiHxU56QsjwYDHXAvCTX1a9BCECeLCYA1sWdzocIoI/Wxavfxf4zs8WnPSEiOChjjXwrbFyuczc3By7u+e35iOEP7c1Zt8dfgl87XeL1WqVjY0N9vb2qFQqDA8PMzY2Rl9fJPkX34vIN7Uv19vj9aVWgbOJem8qWw8P1ykyTbPEJjCJRZdFVQzTBTUMgJVN9SxIj0LWs0YZYtA+U3SN3s8VXBeRL5sVXqfKtrrbuvExJvG41/QakzHectG37bK4lW39EBPNXtE2DjLFwUEA4CwI94H1Dh0LQ+uYbt8W3pP0qh6ZsQXh6h6asgXiah6bswXh6h6crJde1aOzjaQ9dHjaU26AG2mXH5//D2MrUT8QoKlcAAAAAElFTkSuQmCC"},ac6a:function(t,e,i){for(var n=i("cadf"),s=i("0d58"),o=i("2aba"),a=i("7726"),r=i("32e9"),l=i("84f2"),c=i("2b4c"),u=c("iterator"),h=c("toStringTag"),d=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=s(p),m=0;m<v.length;m++){var f,g=v[m],y=p[g],C=a[g],P=C&&C.prototype;if(P&&(P[u]||r(P,u,d),P[h]||r(P,h,g),l[g]=d,y))for(f in n)P[f]||o(P,f,n[f],!0)}},b757:function(t,e,i){},ec9e:function(t,e,i){"use strict";i("b757")}}]);